/*******************************************************************************
 * Educational Online Test Delivery System 
 * Copyright (c) 2014 American Institutes for Research
 *   
 * Distributed under the AIR Open Source License, Version 1.0 
 * See accompanying file AIR-License-1_0.txt or at
 * http://www.smarterapp.org/documents/American_Institutes_for_Research_Open_Source_Software_License.pdf
 ******************************************************************************/
package org.opentestsystem.unittest.db.export;

import java.sql.ResultSet;
import java.sql.SQLException;

import org.dbunit.dataset.datatype.StringDataType;
import org.dbunit.dataset.datatype.TypeCastException;

public class EscapedVarCharDataType extends StringDataType
{
  public EscapedVarCharDataType (String name, int sqlType)
  {
    super (name, sqlType);
  }
  
  @Override
  public Object getSqlValue (int column, ResultSet resultSet)
      throws SQLException, TypeCastException
  {
    String value = resultSet.getString (column);
    if (value == null || resultSet.wasNull ())
    {
      return null;
    }
    value = value.replaceAll ("&", "&amp;").replaceAll (">", "&gt;").replaceAll ("<", "&lt;").replaceAll ("\"", "&quot;");
    return value;
  }
}
